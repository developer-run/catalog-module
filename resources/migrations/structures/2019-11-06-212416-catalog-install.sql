CREATE TABLE catalog_product_images (id INT AUTO_INCREMENT NOT NULL, product_id INT DEFAULT NULL, description VARCHAR(255) DEFAULT NULL, main TINYINT(1) DEFAULT '0' NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, reference_identifier VARCHAR(255) NOT NULL, identifier VARCHAR(255) NOT NULL, `namespace` VARCHAR(255) NOT NULL, name VARCHAR(255) NOT NULL, path VARCHAR(255) NOT NULL, alt VARCHAR(255) DEFAULT NULL, sha VARCHAR(40) DEFAULT NULL, width SMALLINT DEFAULT NULL, height SMALLINT DEFAULT NULL, type VARCHAR(16) DEFAULT NULL, INDEX IDX_1116EDC34584665A (product_id), INDEX name_idx (name), INDEX namespace_idx (namespace), INDEX product_reference_identifier_idx (reference_identifier), INDEX product_identifier_idx (identifier), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_product_variant (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(64) NOT NULL, value VARCHAR(255) NOT NULL, INDEX product_variant_name_idx (name), INDEX product_variant_value_idx (value), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_category (id INT AUTO_INCREMENT NOT NULL, route_id INT DEFAULT NULL, image_id INT DEFAULT NULL, tree_root INT DEFAULT NULL, parent_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, position SMALLINT DEFAULT 0 NOT NULL, name VARCHAR(255) NOT NULL, note VARCHAR(255) DEFAULT NULL, options LONGTEXT DEFAULT NULL COMMENT '(DC2Type:simple_array)', active TINYINT(1) DEFAULT '1' NOT NULL, topped TINYINT(1) DEFAULT '0' NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, lft INT NOT NULL, lvl INT NOT NULL, rgt INT NOT NULL, INDEX IDX_349BC7DF34ECB4E6 (route_id), UNIQUE INDEX UNIQ_349BC7DF3DA5256D (image_id), INDEX IDX_349BC7DFA977936C (tree_root), INDEX IDX_349BC7DF727ACA70 (parent_id), INDEX IDX_349BC7DFB03A8386 (created_by_id), INDEX IDX_349BC7DF896DBBDE (updated_by_id), INDEX IDX_349BC7DFC76F1F52 (deleted_by_id), FULLTEXT INDEX catalog_category_name_idx (name), INDEX catalog_active_idx (active), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_category_translation (id INT AUTO_INCREMENT NOT NULL, translatable_id INT DEFAULT NULL, title VARCHAR(128) DEFAULT NULL, description MEDIUMTEXT DEFAULT NULL, locale VARCHAR(255) NOT NULL, INDEX IDX_6F8863F2C2AC5D3 (translatable_id), FULLTEXT INDEX catalog_title_description_idx (title, description), UNIQUE INDEX catalog_category_translation_unique_translation (translatable_id, locale), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_tracking (id INT AUTO_INCREMENT NOT NULL, route_id INT DEFAULT NULL, category_id INT DEFAULT NULL, product_id INT DEFAULT NULL, session_id VARCHAR(128) NOT NULL, action VARCHAR(255) NOT NULL, message VARCHAR(255) NOT NULL, extra VARCHAR(255) DEFAULT NULL, ip VARCHAR(16) DEFAULT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_9AABBC0234ECB4E6 (route_id), INDEX IDX_9AABBC0212469DE2 (category_id), INDEX IDX_9AABBC024584665A (product_id), INDEX session_idx (session_id), INDEX action_idx (action), INDEX message_idx (message), INDEX ip_idx (ip), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_feed_log (id INT AUTO_INCREMENT NOT NULL, product_id INT DEFAULT NULL, text VARCHAR(255) NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_4F642A4E4584665A (product_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_order (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, product_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, session_id VARCHAR(128) DEFAULT NULL, price NUMERIC(10, 2) NOT NULL, amount INT DEFAULT 1 NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_4C3AF221A76ED395 (user_id), INDEX IDX_4C3AF2214584665A (product_id), INDEX IDX_4C3AF221B03A8386 (created_by_id), INDEX IDX_4C3AF221896DBBDE (updated_by_id), INDEX IDX_4C3AF221C76F1F52 (deleted_by_id), INDEX session_idx (session_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_product_translation (id INT AUTO_INCREMENT NOT NULL, translatable_id INT DEFAULT NULL, title VARCHAR(128) DEFAULT NULL, name VARCHAR(255) NOT NULL, short_description MEDIUMTEXT DEFAULT NULL, description MEDIUMTEXT DEFAULT NULL, locale VARCHAR(255) NOT NULL, INDEX IDX_1290F3B72C2AC5D3 (translatable_id), FULLTEXT INDEX product_fulltext_idx (title, name, short_description, description), UNIQUE INDEX catalog_product_translation_unique_translation (translatable_id, locale), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_product (id INT AUTO_INCREMENT NOT NULL, route_id INT DEFAULT NULL, created_by_id INT DEFAULT NULL, updated_by_id INT DEFAULT NULL, deleted_by_id INT DEFAULT NULL, feed_url VARCHAR(255) DEFAULT NULL, manufacturer VARCHAR(128) DEFAULT NULL, price NUMERIC(10, 2) DEFAULT '0' NOT NULL, dph SMALLINT DEFAULT 0 NOT NULL, discount SMALLINT DEFAULT 0 NOT NULL, in_stock INT DEFAULT 0 NOT NULL, amount INT DEFAULT 1 NOT NULL, delivery_date SMALLINT DEFAULT NULL, published_from DATETIME DEFAULT NULL, published_to DATETIME DEFAULT NULL, position SMALLINT DEFAULT 0 NOT NULL, active TINYINT(1) DEFAULT '1' NOT NULL, action TINYINT(1) DEFAULT '0' NOT NULL, recommend TINYINT(1) DEFAULT '0' NOT NULL, topped TINYINT(1) DEFAULT '0' NOT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, INDEX IDX_DCF8F98134ECB4E6 (route_id), INDEX IDX_DCF8F981B03A8386 (created_by_id), INDEX IDX_DCF8F981896DBBDE (updated_by_id), INDEX IDX_DCF8F981C76F1F52 (deleted_by_id), FULLTEXT INDEX product_manufacturer_idx (manufacturer), INDEX product_active_idx (active), INDEX action_recommend_topped_idx (action, recommend, topped), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_category_products (product_entity_id INT NOT NULL, category_entity_id INT NOT NULL, INDEX IDX_5483B881EF85CBD0 (product_entity_id), INDEX IDX_5483B8814645AF6D (category_entity_id), PRIMARY KEY(product_entity_id, category_entity_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_products_variants (product_entity_id INT NOT NULL, product_variant_entity_id INT NOT NULL, INDEX IDX_F6DA25F2EF85CBD0 (product_entity_id), INDEX IDX_F6DA25F2D65C945D (product_variant_entity_id), PRIMARY KEY(product_entity_id, product_variant_entity_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE catalog_category_image (id INT AUTO_INCREMENT NOT NULL, category_id INT DEFAULT NULL, inserted DATETIME DEFAULT NULL, updated DATETIME DEFAULT NULL, reference_identifier VARCHAR(255) NOT NULL, identifier VARCHAR(255) NOT NULL, `namespace` VARCHAR(255) NOT NULL, name VARCHAR(255) NOT NULL, path VARCHAR(255) NOT NULL, alt VARCHAR(255) DEFAULT NULL, sha VARCHAR(40) DEFAULT NULL, width SMALLINT DEFAULT NULL, height SMALLINT DEFAULT NULL, type VARCHAR(16) DEFAULT NULL, UNIQUE INDEX UNIQ_BE7B591B12469DE2 (category_id), INDEX catalog_category_identifier_idx (identifier), INDEX catalog_category_image_namespace_name_idx (namespace, name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE catalog_product_images ADD CONSTRAINT FK_1116EDC34584665A FOREIGN KEY (product_id) REFERENCES catalog_product (id) ON DELETE CASCADE;
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DF34ECB4E6 FOREIGN KEY (route_id) REFERENCES route (id) ON DELETE CASCADE;
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DF3DA5256D FOREIGN KEY (image_id) REFERENCES catalog_category_image (id);
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DFA977936C FOREIGN KEY (tree_root) REFERENCES catalog_category (id) ON DELETE CASCADE;
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DF727ACA70 FOREIGN KEY (parent_id) REFERENCES catalog_category (id) ON DELETE CASCADE;
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DFB03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DF896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE catalog_category ADD CONSTRAINT FK_349BC7DFC76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE catalog_category_translation ADD CONSTRAINT FK_6F8863F2C2AC5D3 FOREIGN KEY (translatable_id) REFERENCES catalog_category (id) ON DELETE CASCADE;
ALTER TABLE catalog_tracking ADD CONSTRAINT FK_9AABBC0234ECB4E6 FOREIGN KEY (route_id) REFERENCES route (id) ON DELETE SET NULL;
ALTER TABLE catalog_tracking ADD CONSTRAINT FK_9AABBC0212469DE2 FOREIGN KEY (category_id) REFERENCES catalog_category (id) ON DELETE SET NULL;
ALTER TABLE catalog_tracking ADD CONSTRAINT FK_9AABBC024584665A FOREIGN KEY (product_id) REFERENCES catalog_product (id) ON DELETE SET NULL;
ALTER TABLE catalog_feed_log ADD CONSTRAINT FK_4F642A4E4584665A FOREIGN KEY (product_id) REFERENCES catalog_product (id) ON DELETE CASCADE;
ALTER TABLE catalog_order ADD CONSTRAINT FK_4C3AF221A76ED395 FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE;
ALTER TABLE catalog_order ADD CONSTRAINT FK_4C3AF2214584665A FOREIGN KEY (product_id) REFERENCES catalog_product (id) ON DELETE CASCADE;
ALTER TABLE catalog_order ADD CONSTRAINT FK_4C3AF221B03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE catalog_order ADD CONSTRAINT FK_4C3AF221896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE catalog_order ADD CONSTRAINT FK_4C3AF221C76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE catalog_product_translation ADD CONSTRAINT FK_1290F3B72C2AC5D3 FOREIGN KEY (translatable_id) REFERENCES catalog_product (id) ON DELETE CASCADE;
ALTER TABLE catalog_product ADD CONSTRAINT FK_DCF8F98134ECB4E6 FOREIGN KEY (route_id) REFERENCES route (id) ON DELETE CASCADE;
ALTER TABLE catalog_product ADD CONSTRAINT FK_DCF8F981B03A8386 FOREIGN KEY (created_by_id) REFERENCES users (id);
ALTER TABLE catalog_product ADD CONSTRAINT FK_DCF8F981896DBBDE FOREIGN KEY (updated_by_id) REFERENCES users (id);
ALTER TABLE catalog_product ADD CONSTRAINT FK_DCF8F981C76F1F52 FOREIGN KEY (deleted_by_id) REFERENCES users (id);
ALTER TABLE catalog_category_products ADD CONSTRAINT FK_5483B881EF85CBD0 FOREIGN KEY (product_entity_id) REFERENCES catalog_product (id) ON DELETE CASCADE;
ALTER TABLE catalog_category_products ADD CONSTRAINT FK_5483B8814645AF6D FOREIGN KEY (category_entity_id) REFERENCES catalog_category (id) ON DELETE CASCADE;
ALTER TABLE catalog_products_variants ADD CONSTRAINT FK_F6DA25F2EF85CBD0 FOREIGN KEY (product_entity_id) REFERENCES catalog_product (id) ON DELETE CASCADE;
ALTER TABLE catalog_products_variants ADD CONSTRAINT FK_F6DA25F2D65C945D FOREIGN KEY (product_variant_entity_id) REFERENCES catalog_product_variant (id) ON DELETE CASCADE;
ALTER TABLE catalog_category_image ADD CONSTRAINT FK_BE7B591B12469DE2 FOREIGN KEY (category_id) REFERENCES catalog_category (id) ON DELETE CASCADE;
ALTER TABLE catalog_product ADD serial VARCHAR(64) DEFAULT NULL AFTER feed_url;
